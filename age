from docx import Document
import re

def count_bullets_in_sections(file_path):
    inclusion_heading = "Inclusion Criteria"
    exclusion_heading = "Exclusion Criteria"
    
    doc = Document(file_path)
    found_inclusion = False
    found_exclusion = False
    inclusion_bullet_count = 0
    exclusion_bullet_count = 0

    bullet_pattern = re.compile(r"^(\s*[-•*]\s+|\s*\d+\.\s+)")  # Matches "-", "•", "*", or "1.", "2.", etc.

    for para in doc.paragraphs:
        text = para.text.strip()
        if not text:
            continue  # Skip empty paragraphs

        if text.lower().startswith(inclusion_heading.lower()):
            found_inclusion = True
            continue

        if text.lower().startswith(exclusion_heading.lower()):
            found_exclusion = True
            found_inclusion = False  # Stop counting inclusion bullets
            continue

        if found_inclusion and bullet_pattern.match(text):
            inclusion_bullet_count += 1

        if found_exclusion and bullet_pattern.match(text):
            exclusion_bullet_count += 1

    return {
        "Inclusion Criteria Bullets": inclusion_bullet_count,
        "Exclusion Criteria Bullets": exclusion_bullet_count
    }

# Provide the file path for extraction (replace with actual file path)
file_path = "your_file.docx"
bullet_counts = count_bullets_in_sections(file_path)
print(bullet_counts)
